{{- $valuesAtStart := .Values}}
{{- if ($valuesAtStart.grafanaurl) }}

apiVersion: v1
items:
- apiVersion: v1
  data:
    dashboards: "[
      { \"annotations\": { \"list\": [ { \"builtIn\": 1, \"datasource\": \"-- Grafana --\", \"enable\": true, \"hide\": true, \"iconColor\": \"rgba(0, 211, 255, 1)\", \"name\": \"Annotations & Alerts\", \"type\": \"dashboard\" } ] }, \"description\": \"Loki logs panel with prometheus variables \", \"editable\": true, \"gnetId\": 12019, \"graphTooltip\": 0, \"id\": null, \"iteration\": 1629266148215, \"links\": [], \"panels\": [ { \"aliasColors\": {}, \"bars\": false, \"dashLength\": 10, \"dashes\": false, \"datasource\": \"Loki\", \"fieldConfig\": { \"defaults\": { \"links\": [] }, \"overrides\": [] }, \"fill\": 1, \"fillGradient\": 0, \"gridPos\": { \"h\": 9, \"w\": 24, \"x\": 0, \"y\": 0 }, \"hiddenSeries\": false, \"id\": 4, \"legend\": { \"alignAsTable\": false, \"avg\": false, \"current\": true, \"hideEmpty\": true, \"hideZero\": true, \"max\": false, \"min\": false, \"rightSide\": false, \"show\": false, \"total\": false, \"values\": true }, \"lines\": true, \"linewidth\": 1, \"nullPointMode\": \"null\", \"options\": { \"alertThreshold\": true }, \"percentage\": false, \"pluginVersion\": \"7.5.3\", \"pointradius\": 2, \"points\": false, \"renderer\": \"flot\", \"seriesOverrides\": [], \"spaceLength\": 10, \"stack\": false, \"steppedLine\": false, \"targets\": [ { \"expr\": \"sum(rate({namespace=~\\\"$namespace\\\",app=~\\\"$app\\\", level=~\\\"$level\\\"} |= \\\"$search\\\" [5m] )) by (namespace,app,pod)\", \"refId\": \"A\" } ], \"thresholds\": [], \"timeFrom\": null, \"timeRegions\": [], \"timeShift\": null, \"title\": \"Log rate\", \"tooltip\": { \"shared\": false, \"sort\": 0, \"value_type\": \"individual\" }, \"type\": \"graph\", \"xaxis\": { \"buckets\": null, \"mode\": \"time\", \"name\": null, \"show\": true, \"values\": [] }, \"yaxes\": [ { \"format\": \"short\", \"label\": null, \"logBase\": 1, \"max\": null, \"min\": null, \"show\": true }, { \"format\": \"short\", \"label\": null, \"logBase\": 1, \"max\": null, \"min\": null, \"show\": false } ], \"yaxis\": { \"align\": false, \"alignLevel\": null } }, { \"datasource\": \"Loki\", \"fieldConfig\": { \"defaults\": {}, \"overrides\": [] }, \"gridPos\": { \"h\": 30, \"w\": 24, \"x\": 0, \"y\": 9 }, \"id\": 2, \"maxDataPoints\": \"\", \"options\": { \"dedupStrategy\": \"none\", \"showLabels\": false, \"showTime\": true, \"sortOrder\": \"Descending\", \"wrapLogMessage\": true }, \"targets\": [ { \"expr\": \"{namespace=~\\\"$namespace\\\",app=~\\\"$app\\\", level=~\\\"$level\\\"} |= \\\"$search\\\" \", \"refId\": \"A\" } ], \"timeFrom\": null, \"timeShift\": null, \"title\": \"Logs Panel\", \"type\": \"logs\" } ], \"refresh\": false, \"schemaVersion\": 27, \"style\": \"dark\", \"tags\": [], \"templating\": { \"list\": [ { \"allValue\": \".*\", \"current\": { \"selected\": false, \"text\": \"All\", \"value\": \"$__all\" }, \"datasource\": \"prometheus\", \"definition\": \"label_values(namespace)\", \"description\": null, \"error\": null, \"hide\": 0, \"includeAll\": true, \"label\": null, \"multi\": false, \"name\": \"namespace\", \"options\": [], \"query\": { \"query\": \"label_values(namespace)\", \"refId\": \"prometheus-namespace-Variable-Query\" }, \"refresh\": 1, \"regex\": \"\", \"skipUrlSync\": false, \"sort\": 1, \"tagValuesQuery\": \"\", \"tags\": [], \"tagsQuery\": \"\", \"type\": \"query\", \"useTags\": false }, { \"allValue\": \".*\", \"current\": { \"selected\": true, \"text\": [ \"All\" ], \"value\": [ \"$__all\" ] }, \"datasource\": \"Loki\", \"definition\": \"label_values(app)\", \"description\": null, \"error\": null, \"hide\": 0, \"includeAll\": true, \"label\": \"app\", \"multi\": true, \"name\": \"app\", \"options\": [], \"query\": \"label_values(app)\", \"refresh\": 2, \"regex\": \"\", \"skipUrlSync\": false, \"sort\": 1, \"tagValuesQuery\": \"\", \"tags\": [], \"tagsQuery\": \"\", \"type\": \"query\", \"useTags\": false }, { \"allValue\": \".*\", \"current\": { \"selected\": true, \"text\": [ \"All\" ], \"value\": [ \"$__all\" ] }, \"datasource\": \"prometheus\", \"definition\": \"label_values(pod)\", \"description\": null, \"error\": null, \"hide\": 2, \"includeAll\": true, \"label\": null, \"multi\": true, \"name\": \"pod\", \"options\": [], \"query\": { \"query\": \"label_values(pod)\", \"refId\": \"prometheus-pod-Variable-Query\" }, \"refresh\": 2, \"regex\": \"\", \"skipUrlSync\": false, \"sort\": 0, \"tagValuesQuery\": \"\", \"tags\": [], \"tagsQuery\": \"\", \"type\": \"query\", \"useTags\": false }, { \"allValue\": \".*\", \"current\": { \"selected\": true, \"text\": [ \"All\" ], \"value\": [ \"$__all\" ] }, \"datasource\": \"Loki\", \"definition\": \"label_values(level)\", \"description\": null, \"error\": null, \"hide\": 0, \"includeAll\": true, \"label\": \"level\", \"multi\": true, \"name\": \"level\", \"options\": [], \"query\": \"label_values(level)\", \"refresh\": 2, \"regex\": \"\", \"skipUrlSync\": false, \"sort\": 0, \"tagValuesQuery\": \"\", \"tags\": [], \"tagsQuery\": \"\", \"type\": \"query\", \"useTags\": false }, { \"current\": { \"selected\": false, \"text\": \"\", \"value\": \"\" }, \"description\": null, \"error\": null, \"hide\": 0, \"label\": null, \"name\": \"search\", \"options\": [ { \"selected\": true, \"text\": \"\", \"value\": \"\" } ], \"query\": \"\", \"skipUrlSync\": false, \"type\": \"textbox\" } ] }, \"time\": { \"from\": \"now-30m\", \"to\": \"now\" }, \"timepicker\": { \"refresh_intervals\": [ \"5s\", \"10s\", \"30s\", \"1m\", \"5m\", \"15m\", \"30m\", \"1h\", \"2h\", \"1d\" ] }, \"timezone\": \"\", \"title\": \"Loki Dashboard quick search\", \"uid\": \"liz0yRCZz\", \"version\": 1 }
    ]"
  kind: ConfigMap
  metadata:
    creationTimestamp: null
    name:  grafana-tenant-dashboards
kind: List
metadata: {}

{{ end }}
